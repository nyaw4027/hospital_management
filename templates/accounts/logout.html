{% extends 'shared/base.html' %}

{% block title %}Settings | HMS Core{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row g-4">
        <div class="col-lg-4">
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden sticky-lg-top" style="top: 100px;">
                <div class="p-4 text-center bg-light border-bottom">
                    <div class="bg-primary text-white d-inline-block p-3 rounded-circle mb-2 shadow-sm">
                        <i class="fas fa-user-md fa-2x"></i>
                    </div>
                    <h5 class="fw-bold mb-0">{{ user.username|title }}</h5>
                    <small class="text-muted">{{ user.role|title }} Account</small>
                </div>

                <div class="list-group list-group-flush">
                    <a href="#personal-info" class="list-group-item list-group-item-action border-0 p-3 active">
                        <i class="fas fa-id-card me-3"></i>Personal Information
                    </a>
                    <a href="{% url 'password_change' %}" class="list-group-item list-group-item-action border-0 p-3">
                        <i class="fas fa-key me-3"></i>Security & Password
                    </a>
                    <a href="#connections" class="list-group-item list-group-item-action border-0 p-3">
                        <i class="fas fa-link me-3"></i>Account Connections
                    </a>
                    <a href="#display" class="list-group-item list-group-item-action border-0 p-3">
                        <i class="fas fa-palette me-3"></i>Display Preferences
                    </a>
                    <button type="button" class="list-group-item list-group-item-action border-0 p-3 text-danger fw-bold" 
                            data-bs-toggle="modal" data-bs-target="#logoutModal">
                        <i class="fas fa-power-off me-3"></i>Sign Out
                    </button>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div id="personal-info" class="card border-0 shadow-sm rounded-4 p-4 mb-4">
                <h5 class="fw-bold mb-4">Personal Information</h5>
                <form method="post">
                    {% csrf_token %}
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">Email Address</label>
                            <input type="email" class="form-control rounded-3" value="{{ user.email }}">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold">Display Name</label>
                            <input type="text" class="form-control rounded-3" value="{{ user.username }}">
                        </div>
                        <div class="col-12 text-end mt-4">
                            <button type="submit" class="btn btn-primary rounded-pill px-4">Update Profile</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="logoutModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow rounded-4">
            <div class="bg-danger py-2 rounded-top-4"></div>
            <div class="modal-body p-5 text-center">
                <div class="bg-danger-subtle d-inline-block p-4 rounded-circle mb-4">
                    <i class="fas fa-sign-out-alt fa-3x text-danger"></i>
                </div>
                <h3 class="fw-bold mb-2">End Session?</h3>
                <p class="text-muted mb-4">
                    Are you sure you want to sign out? Make sure any clinical notes are saved before leaving.
                </p>
                
                <form method="post" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <div class="d-grid gap-3">
                        <button type="submit" class="btn btn-danger btn-lg rounded-pill fw-bold">Confirm Sign Out</button>
                        <button type="button" class="btn btn-light btn-lg rounded-pill fw-bold border" data-bs-dismiss="modal">Stay Logged In</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}